{
    "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>   <?xml-stylesheet type=\"text/xsl\" href=\"rfc2629.xslt\" ?>   <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.0.22 -->  <!DOCTYPE rfc SYSTEM \"rfc2629.dtd\" [ ]>  <?rfc toc=\"yes\"?> <?rfc sortrefs=\"yes\"?> <?rfc symrefs=\"yes\"?>  <rfc ipr=\"trust200902\" docName=\"draft-akagiri-op25b-dynamicip-00.txt\" category=\"info\">    <front>     <title abbrev=\"OP25B\">Outbound Port 25 Blocking for Dynamic IP Addresses</title>      <author initials=\"T.\" surname=\"Akagiri\" fullname=\"Takehito Akagiri\">       <organization>Rakuten, Inc.</organization>       <address>         <email>takehito.akagiri@mail.rakuten.com</email>       </address>     </author>     <author initials=\"K.\" surname=\"Wakamatsu\" fullname=\"Koji Wakamatsu\">       <organization>SoftBank Mobile Corp.</organization>       <address>         <email>koji.wakamatsu@g.softbank.co.jp</email>       </address>     </author>     <author initials=\"K.\" surname=\"Okada\" fullname=\"Kouji Okada\">       <organization>Lepidum Co. Ltd.</organization>       <address>         <email>okd@lepidum.co.jp</email>       </address>     </author>     <author initials=\"K.\" surname=\"Maeda\" fullname=\"Kaoru Maeda\">       <organization>Lepidum Co. Ltd.</organization>       <address>         <email>maeda@lepidum.co.jp</email>       </address>     </author>      <date year=\"2015\" month=\"March\" day=\"09\"/>      <area>Application</area>     <workgroup>Applications Area Working Group</workgroup>     <keyword>Internet-Draft</keyword>      <abstract>   <t>Outbound Port 25 Blocking has been widely used over a decade as a countermeasure against mail spams. It is the operation to filter TCP traffic which (1) the source IP addresses are dynamic IP addresses and (2) the destination port is 25. Since ordinal mail message submissions from dynamic IP addresses can be done via submission port (port number 587), operators can introduce the blocking without preventing ordinal mail message submissions. We explain current OP25B operations in this document.</t>        </abstract>     </front>    <middle>   <section anchor=\"introduction\" title=\"Introduction\">  <t>Countermeasures for spam mails are categorized into two types, \\ufffd\\ufffd\\ufffdto block sending spam mails\\ufffd\\ufffd\\ufffd and \\ufffd\\ufffd\\ufffdnot to receive spam mails\\ufffd\\ufffd\\ufffd. Outbound Port 25 Blocking (OP25B) is one of the former approaches. Blocking a spam mail inside the spam origin domain is more desirable as the spam distributed domain is limited to one domain.</t>  <t>The way spam senders send spam mails are categorized into three types.</t>  <t><list style=\"numbers\">   <t>Spam senders refer MX RR from dynamic IP addresses to send spam mails directly to target MTAs.</t>   <t>Spam senders send spams via webmail MSAs.</t>   <t>Spam senders obtain static IP addresses to send spam mails.</t> </list></t>  <t>OP25B prevents approach 1. By introducing OP25B, network operators can focus on actions against spam mails from static addresses.</t>  <t>At the time OP25B was first introduced, there were two issues that we needed to consider. Submission port (port number 587) was not yet fully adopted, and the number of filtering rules hit performance of network routers. These have been solved these days, enabling easier OP25B deployment. While OP25B becomes widespread in this decade, this document summarize current OP25B practices to help newly introducing the blocking.</t>  </section> <section anchor=\"sec_terminology\" title=\"Terminology\">  <t><list style=\"symbols\">   <t>Mail User Agent(MUA): user application which submit email messages to MSA</t>   <t>Mail Submission Agent(MSA): program which receive submitted email messages from MUA and forward them</t>   <t>Mail Transfer Agent(MTA): programs which receive forwarded email messages from MSA or MTA and forward them </t>   <t>submit: The action by the MUA of entrusting the deliveries of email messages to MSA</t>   <t>forward: actions which MTA(or MSA) entrust the deliveries of email messages to other MTAs</t>   <t>subscriber: User who establishes account(s) with some ISP(s)             to obtain Internet connectivity</t> </list></t>  <t><xref target=\"fig_single_server\"/> and <xref target=\"fig_separate_server\"/> are the typical pattern diagrams of mail components. <xref target=\"fig_single_server\"/> is the diagram which single server doubles as MSA and MTA.  <xref target=\"fig_separate_server\"/> is the diagram which MSA and MTA are separated.</t>  <figure title=\"Single server model\" anchor=\"fig_single_server\"><artwork><![CDATA[ +-------------+                  +---------------+ |             |        forwarding| +-----------+ | |  +-------+ +-------------------> | +-------+ | | |  |  MTA  |  |       +----------> | |  MTA  | | | |  +-------+  |       |submission| | +-------+ | | |             |       |          | +-+-------+-+ | +-------------+       |          |  mail server  |                  +----|------+   |               |                  |    |      |   +---------------+                  +----|+-----+                                           ||                                                +++-+                                              |MUA|                                              +---+                         ]]></artwork></figure>  <t>In <xref target=\"fig_single_server\"/>, single SMTP server utilizes port 25 both for submissions and forwarding, that is, MSA and MTA cannot be distinguished. In this document, submissions to this kind of SMTP servers are called \\ufffd\\ufffd\\ufffdsubmissions to MTA\\ufffd\\ufffd\\ufffd. In <xref target=\"fig_separate_server\"/>, different SMTP servers engage in submissions and forwarding respectively, that is, MSA and MTA can be distinguished. In this document, SMTP servers which serve port 25 for mail submissions are called MSA[25].</t>  <figure title=\"Separate server model\" anchor=\"fig_separate_server\"><artwork><![CDATA[ +-------------+                  +-+-----------+-+ |             |        forwarding| +-----------+ | |  +-------+ +-------------------> | +-------+ | | |  |  MTA  |  |                  | | |  MTA  | | | |  +-------+  |                  | | +-------+ | | |             |                  | +-+---------+ | +-------------+        submission|  mail server  |                  +-----------+   | +-+---------+ |                  |    +----------> | +-------+ | |                  +----|------+   | | |  MSA  | | |                       ||         | | +-------+ | |                      +++-+       | +-+-------+-+ |                      |MUA|       |  mail server  |                      +---+       +---------------+ ]]></artwork></figure>  </section> <section anchor=\"mail-distribution-models\" title=\"Mail Distribution Models\">  <section anchor=\"sec_ips_models\" title=\"ISP models\">  <t>In this document, we categorize ISPs into 3 types:</t>  <t><list style=\"numbers\">   <t>ISP model A: ISP that provides Internet connectivity services to other ISPs (model B)</t>   <t>ISP model B: ISP that depends on end-user Internet connectivity on other ISPs (model A)</t>   <t>ISP model C: ISP that utilize their internet connectivity for their own services only.</t> </list></t>  <t><xref target=\"fig_isp_models\"/> shows how end clients are connected to the Internet through 3 types of ISPs.</t>  <t><list style=\"symbols\">   <t>(A): the Internet connectivity for subscribers of ISPs of model A</t>   <t>(B): the Internet connectivity for subscribers of ISPs of model B</t>   <t>(C): the Internet connectivity for subscribers of ISPs of model C</t> </list></t>  <figure title=\"ISP models\" anchor=\"fig_isp_models\"><artwork><![CDATA[                      +----------------------+                                            |Internet              |                                            |     +-----+    ^ ^ ^ |                       MSA of model B ISP+--------+ MSA | <--+ | | |                                            |     +-----+    | | | |                             +-------------------------------+ | | |                             |              |  +---------------+ | |                             |              +--|-----------------|-+                             |                 |                 +-----------------+             |                 |                                   |           +-+-----------------|--+           +--------------------|-+         |model A ISP        |  |           |model C ISP         | |         | |(B)           (A)|  |           |                 (C)| |         | |     +-----+     |  |           |          +-----+   | |         | |     | MSA | <---+  |           |          | MSA | <-+ |         | |     +-----+     |  |           |          +-----+   | |         | |                 |  |           |                    | |         +-|------+---+------|--+           +--------------------|-+         +-|------+   +------|--+           +--------------------|-+         | |      |   |      |  |  Access   |                    | |         +-|------+   +------|--+  Network  +--------------------|-+           |                 |                                   |           +-+-+             +-+-+                               +-+-+         |MUA|             |MUA|                               |MUA|         +---+             +---+                               +---+     subscriber of     subscriber of                       subscriber of model B ISP       model A ISP                         model C ISP   ]]></artwork></figure>  <t>All subscribers of ISPs of model A and model C are connected to the Internet via ISPs to which they subscribe. In <xref target=\"fig_isp_models\"/>, MSAs for these subscribers are located in ISPs users are subscribing to. Lines with labels (A) and (C) in the figure depict the communication between MSAs and clients in ISPs of model A and model C respectively. Subscribers in the ISPs of model B are connected to the Internet via ISPs of model A. This is shown by the line labeled as (B) in the figure. In this case, MSAs are located somewhere on the Internet.</t>  </section> <section anchor=\"sec_mail_path\" title=\"Mail distribution path\">  <t>3 figures in this section show the mail distribution paths in the current mail architecture. These figures depict \\ufffd\\ufffd\\ufffdvalid mail submission\\ufffd\\ufffd\\ufffd scenario, \\ufffd\\ufffd\\ufffdinvalid mail submission\\ufffd\\ufffd\\ufffd scenario and \\ufffd\\ufffd\\ufffdvalid mail forwarding\\ufffd\\ufffd\\ufffd scenario respectively. In the figures, ISP A is the mail sender, and ISP B, ISP C, cellular carrier and \\ufffd\\ufffd\\ufffdASP/Hosting/Business Enterprise/Academic institution\\ufffd\\ufffd\\ufffd are mail receivers.</t>  <t><list style=\"symbols\">   <t>ISP A: ISP of model A</t>   <t>ISP B: ISP of model B</t>   <t>ISP C: ISP of model C</t>   <t>MUA: Client PCs which obtain dynamic IP addresses and run MUAs. These MUAs include:   <list style=\"symbols\">       <t>Valid User PCs: ISP subscribers\\ufffd\\ufffd\\ufffd PCs (not include spam senders or bots)</t>       <t>Spam senders</t>       <t>Bots</t>     </list></t> </list></t>  <figure title=\"Valid Mail Submission\" anchor=\"fig_valid_submission\"><artwork><![CDATA[              +------------------------+  +------------------------+              |ASP/Hosting/            |  |Cellular carrier        |              |Business Enterprise/    |  |                        |              |Academic institution    |  |                        |              |    +--------------+    |  |  +-------+  +-------+  |              |    |   MSA/MTA    |    |  |  |  MTA  |  |  MSA  |  |              |    +--------------+    |  |  +-------+  +-------+  |              |        (b)^            |  |              (e)^      |              +-----------|------------+  +-----------------|------+ +------------+           +----------+- - - - - - - - - - - +        |       ISP B|                      |             +---------------+ |            |                      |             |          ISP C| |  +-------+ |                      |             |  +-------+    | |  |  MTA  | |                      |      (b)    |  |  MTA  |    | |  |  MSA  | |                      +--------------> |  MSA  |    | |  +-------+ |                      |             |  +-------+    | |    ^       |                      |             |   ^           | |    |       |                      |             |   |(b)        | | +---------------------------------|-------+     +---------------+ | |  |       |                      |       |         |             | |  |       |      +-------+       |       |       +-+-+    +---+  | |  |(b)    |      |  MSA  |       |       |       |MUA|    |MUA|  | |  |       |      +-------+       |       |       +---+    +---+  | |  |       |             ^(a)     |  ISP A|                       +-+----------+-------------|--------|-------+                            |                     +--------|                                  +-+-+        +---+             +-+-+                                |MUA|        |MUA| bot(zombie) |MUA|                                +---+        +---+ spam sender +---+                             ]]></artwork></figure>  <t><xref target=\"fig_valid_submission\"/> shows valid mail submissions by ISP subscribers. These submissions MUST NOT be disrupted by OP25B.</t>  <t><list style=\"symbols\">   <t>(a): submissions from MUA to MSA of ISP A</t>   <t>(b): submissions from MUA to MSA located outside of ISP A</t>   <t>(e): submissions from MUA to cellular carriers (These submissions do not exist in the real world. This is detailed in <xref target=\"sec_op25b_cellular\"/>)</t> </list></t>  <figure anchor=\"fig_invalid_submission\"><artwork><![CDATA[              +------------------------+  +------------------------+              |ASP/Hosting/            |  |Cellular carrier        |              |Business Enterprise/    |  |                        |              |Academic institution    |  |                        |              |    +--------------+    |  |  +-------+  +-------+  |              |    |   MSA/MTA    |    |  |  |  MTA  |  |  MSA  |  |              |    +------+-------+    |  |  +---+---+  +-------+  |              |        (c)^            |  |   (d)^                 |              +----+------|------------+  +------|-----------------+ +------------+    +------+----------------------+                   |       ISP B|    |                               +---------------+ |            |    |                               |          ISP C| |  +-------+ |    |                               |  +-------+    | |  |  MTA  | (c)  |                              (c) |  MTA  |    | |  |  MSA  | <----+--------------------------------> |  MSA  |    | |  +-------+ |    |                               |  +-------+    | |            |    |                               |               | |            |    |                               |               | | +---------------|-------------------------+     +---------------+ | |          |    |                         |                       | |          |    | +-------+               |       +---+    +---+  | |          |    | |  MSA  |               |       |MUA|    |MUA|  | |          |    | +-------+               |       +---+    +---+  | |          |    |     ^(f)           ISP A|                       +-+----------+----|-----|-------------------+                                         | +---+                                               +---+        +-+-+             +---+                                |MUA|        |MUA| bot(zombie) |MUA|                                +---+        +---+ spam sender +---+                             ]]></artwork></figure>  <t><xref target=\"fig_invalid_submission\"/> shows invalid mail submissions by spam senders or bots. These submissions are the block target of OP25B.</t>  <t><list style=\"symbols\">   <t>(c): submissions from spam senders or bots to MTAs located outside of ISP A</t>   <t>(d): submissions from spam senders or bots to MTAs located in cellular carriers</t>   <t>(f): submissions from spam senders or bots to MSAs of ISP A</t> </list></t>  <figure title=\"Valid Mail Forwarding\" anchor=\"fig_forwarding\"><artwork><![CDATA[              +------------------------+  +------------------------+              |ASP/Hosting/            |  |Cellular carrier        |              |Business Enterprise/    |  |                        |              |Academic institution    |  |                        |              |    +--------------+    |  |  +-------+  +-------+  |              |    |   MSA/MTA    |    |  |  |  MTA  |  |  MSA  |  |              |    +--------------+    |  |  +-------+  +-------+  |              |       (g)^             |  |   (g)^                 |              +----------|-------------+  +------|-----------------+ +------------+          +-----------------------+                   |       ISP B|          |                         +---------------+ |            |          |                         |          ISP C| |  +-------+ |          |                         |  +-------+    | |  |  MTA  | (g)        |                        (g) |  MTA  |    | |  |  MSA  | <----------+--------------------------> |  MSA  |    | |  +-------+ |          |                         |  +-------+    | |            |          |                         |               | |            |          |                         |               | | +---------------------|-------------------+     +---------------+ | |          |          |                   |                       | |          |      +-------+               |       +---+    +---+  | |          |      |  MSA  |               |       |MUA|    |MUA|  | |          |      +-------+               |       +---+    +---+  | |          |                         ISP A|                       +-+----------+------------------------------+                                                                                              +---+        +---+             +---+                                |MUA|        |MUA| bot(zombie) |MUA|                                +---+        +---+ spam sender +---+                             ]]></artwork></figure>  <t><xref target=\"fig_forwarding\"/> shows valid mail forwarding between MSAs and MTAs. The forwarding MUST NOT be disrupted by OP25B.</t>  <t><list style=\"symbols\">   <t>(g): mail deliveries between MTAs or deliveries from MSAs to MTAs</t> </list></t>  </section> <section anchor=\"sec_spam_strategies\" title=\"Spam sender strategies and countermeasures\">  <t>Spam senders\\ufffd\\ufffd\\ufffd strategies can be categorized into two patterns:</t>  <t><list style=\"numbers\">   <t>Pattern I: submit spam mails to MSA and let the MSA to distribute them.</t>   <t>Pattern II: submit spam mails directly to target MSAs from dynamic IP addresses.</t> </list></t>  <figure title=\"Spam sender strategy: Pattern I\" anchor=\"fig_spam_pattern_i\"><artwork><![CDATA[              +------------------------+  +------------------------+              |ASP/Hosting/            |  |Cellular carrier        |              |Business Enterprise/    |  |                        |              |Academic institution    |  |                        |              |    +--------------+    |  |  +-------+  +-------+  |              |    |   MSA/MTA    |    |  |  |  MTA  |  |  MSA  |  |              |    +--------------+    |  |  +-------+  +-------+  |              |       (g)^             |  |   (g)^                 |              +----------|-------------+  +------|-----------------+ +------------+          +-----------------------+                   |       ISP B|          |                         +---------------+ |            |          |                         |          ISP C| |  +-------+ |          |                         |  +-------+    | |  |  MTA  | (g)        |                        (g) |  MTA  |    | |  |  MSA  | <----------+--------------------------> |  MSA  |    | |  +-------+ |          |                         |  +-------+    | |            |          |                         |               | |            |          |                         |               | | +---------------------|-------------------+     +---------------+ | |          |          |                   |                       | |          |      +-------+               |       +---+    +---+  | |          |      |  MSA  |               |       |MUA|    |MUA|  | |          |      +-------+               |       +---+    +---+  | |          |          ^(f)           ISP A|                       +-+----------+----------|-------------------+                                         +-----+                                               +---+        +-+-+             +---+                                |MUA|        |MUA| bot(zombie) |MUA|                                +---+        +---+ spam sender +---+                             ]]></artwork></figure>  <t><xref target=\"fig_spam_pattern_i\"/> shows a spam sender strategy of pattern I. First, spam senders submit spam mails to the MSA (line labeled with (f)). Then, the submitted spam mails are delivered to MTAs of target domains (line labeled with (g)). In this scenario, the mail distribution paths are same as one via which subscribers send valid email messages. Possible countermeasure is to set a quota with user authentication.</t>  <figure title=\"Spam sender strategy: Pattern II\" anchor=\"fig_spam_pattern_ii\"><artwork><![CDATA[              +------------------------+  +------------------------+              |ASP/Hosting/            |  |Cellular carrier        |              |Business Enterprise/    |  |                        |              |Academic institution    |  |                        |              |    +--------------+    |  |  +-------+  +-------+  |              |    |   MSA/MTA    |    |  |  |  MTA  |  |  MSA  |  |              |    +------+-------+    |  |  +---+---+  +-------+  |              |        (c)^            |  |   (d)^                 |              +-----------|------------+  +------|-----------------+ +------------+    +------+----------------------+                   |       ISP B|    |                               +---------------+ |            |    |                               |          ISP C| |  +-------+ |    |                               |  +-------+    | |  |  MTA  | (c)  |                              (c) |  MTA  |    | |  |  MSA  | <----+--------------------------------> |  MSA  |    | |  +-------+ |    |                               |  +-------+    | |            |    |                               |               | |            |    |                               |               | | +---------------|-------------------------+     +---------------+ | |          |    |                         |                       | |          |    | +-------+               |       +---+    +---+  | |          |    | |  MSA  |               |       |MUA|    |MUA|  | |          |    | +-------+               |       +---+    +---+  | |          |    |                    ISP A|                       +-+----------+----|-------------------------+                                         |                                                     +---+        +-+-+             +---+                                |MUA|        |MUA| bot(zombie) |MUA|                                +---+        +---+ spam sender +---+                              ]]></artwork></figure>  <t>Figure <xref target=\"fig_spam_pattern_ii\"/> shows a spam sender strategy of pattern II. First, spam senders obtain dynamic IP addresses on their client PCs. Then, spam senders send spam mails directly to MTAs in target domains from the dynamic IP addresses. (lines labeled with (c) and (d)) A countermeasure for this strategy is OP25B.</t>  </section> </section> <section anchor=\"sec_op25b_top\" title=\"Outbound Port 25 Blocking\">  <t>In this document, we define OP25B as \\ufffd\\ufffd\\ufffdfiltering of the TCP traffic which the source addresses are dynamic IP addresses and the destination port is 25\\ufffd\\ufffd\\ufffd. In <xref target=\"sec_mail_path\"/>, we explained the relation between mail distribution paths and OP25B in <xref target=\"fig_valid_submission\"/>, <xref target=\"fig_invalid_submission\"/>, and <xref target=\"fig_forwarding\"/>. The alphabets \\ufffd\\ufffd\\ufffda\\ufffd\\ufffd\\ufffd to \\ufffd\\ufffd\\ufffdg\\ufffd\\ufffd\\ufffd in the following paragraph refers to the arrows labeled with those alphabets in the above three figures.</t>  <t>After ISP A implements OP25B, a mail sender can send email messages via MSA which ISP A serves (a, g) while they cannot send email messages via other paths (c, d). Thus subscribers of ISP A are ensured a method to send email messages via MSAs. By OP25B, operators can prevent spams sent by spam sender strategy pattern II. We define OP25B for the line labeled (d) as \\ufffd\\ufffd\\ufffdOP25B bound for cellular carriers only\\ufffd\\ufffd\\ufffd and OP25B for the line (c) and (d) as \\ufffd\\ufffd\\ufffdcomplete OP25B\\ufffd\\ufffd\\ufffd.</t>  <t>OP25B is implemented by configuring access control lists (ACL) on the network devices located on the ISP backbone networks. We call the location where those network devices are located \\ufffd\\ufffd\\ufffdblocking points\\ufffd\\ufffd\\ufffd.</t>  <t>Below is an example of filtering policies to filter spams from dynamic IP addresses.</t>  <t><list style=\"numbers\">   <t>Allow traffic from dynamic IP addresses to port 25 of designated MSAs</t>   <t>Deny all traffic to port 25 of MSAs other than MSAs described in 1</t>   <t>No filtering rules for static IP addresses</t> </list></t>  <t>This is one of the simplest filtering policies. The access control rules could differ depending on the specifications of the devices to filter or services policies of network domains.</t>  <t>The numbers of ACL rules are calculated using this formula:</t>  <t>(# of ACL rules) = (# of dynamic IP address blocks) * (# of MSA address blocks + 1)</t>  <t>For example, if the number of dynamic IP address blocks is 100 and the number of MSA address blocks is 10, the number of ACL rules is 1100 = 100 * (10+1). The number of ACL rules directly influences the costs such as filter performance of the network devices and/or filter rule management of network operators. In this example, the ISP which intends to implement OP25B has to introduce network devices that have enough performance to handle 1100 ACL entries. In the model A ISPs, the number of MSA address blocks to \\ufffd\\ufffd\\ufffdpermit\\ufffd\\ufffd\\ufffd can be increased dependent on the numbers of ISPs of model B to serve connectivity. On the other hand, the number of ACL entities are generally fewer in ISPs of model C, because they can concentrate on their internal MSAs only.</t>  <figure title=\"Blocking point analysis\" anchor=\"fig_blocking_point\"><artwork><![CDATA[ +--------------------------------+                            Core Side |The Internet                    |                                ^     |                                |                                |     +------+-------------------------+                                |            |                                                          |         +--+---+                        +-+ [Point 4]                 |     +---+Router+---------------------+    | Core side of backbone     |     |   +------+                     |  +-+                           |     |Bacbone Network                 |                                |     |(Core Network)                  |                                |     |                                |                                |     +-------+-----------------+------+                                |             |                 |                                       |         +---+--+          +---+--+      +-+ [Point 3]                 |     +---+Router+---+  +---+Router+---+    | Edge side of backbone     |     |   +------+   |  |   +------+   |  +-+                           |     |   Access     |  |   Access     |                                |     |   Network    |  |   Network    |                                |     |+---+    +---+|  |+---+    +---+|  +-+ [Point 2]                 |     +|OLT|----|OLT|+  +|OLT|----|OLT|+    | OLT, Terminator           |      +-+-+    +-+-+    +-+-+    +-+-+   +-+                           |        |        |        |        |                                   |     +--+--+  +--+--+  +--+--+  +--+--+  +-+ [Point 1]                 |     |modem|  |modem|  |modem|  |modem|    | Home router               |     +--+--+  +--+--+  +--+--+  +--+--+  +-+                           |        |        |        |        |                                   |      +-+-+    +-+-+    +-+-+    +-+-+                                 |      |MUA|    |MUA|    |MUA|    |MUA|                                 |      +---+    +---+    +---+    +---+                             Edge Side  ]]></artwork></figure>  <t><xref target=\"fig_blocking_point\"/> shows a blocking point analysis in a backbone network. If the blocking point get closer to the \\ufffd\\ufffd\\ufffdcore side\\ufffd\\ufffd\\ufffd, the performance requirements for the filtering network devices increase while the number of the network devices operators have to configure comes down. On the other hand, If the blocking point get closer to the \\ufffd\\ufffd\\ufffdedge side\\ufffd\\ufffd\\ufffd, the performance requirements for the filtering network devices decrease while the number of the network devices operators have to configure comes up. </t>  <t>In the case point 1 is selected as the blocking point, the filtering configurations are set to home routers in subscribers\\ufffd\\ufffd\\ufffd home networks. The advantages of this approach are:</t>  <t><list style=\"symbols\">   <t>Fewer ACL rules on each network devices</t>   <t>No spam mail traffic to the backbone network</t>   <t>No additional configurations to the network devices in the backbone network</t> </list></t>  <t>The ISPs who can employ this method are the ISPs which can control home routers from network operations centers.</t>  <t>In the case of point 2, the blocking point is set to the terminating devices of the access networks. The configurations are done using Radius attributes.</t>  <t>In the case of point 3, the blocking points are the routers located between access networks and the backbone networks. This approach is expected to be most common.</t>  <t>In the case of point 4, the network devices located near to the ISP border gateways are the blocking point. In this case, relatively small amount of the devices are engaged in filtering and huge amount of ACL rules are configured to each network devices. The performance requirements for the devices are high enough to withstand the load.</t>  <section anchor=\"deployment-considerations\" title=\"Deployment Considerations\">  <t>As mentioned in <xref target=\"sec_terminology\"/>, currently port 25 is used for mail submissions. When the complete OP25B is employed by an ISP, the subscribers in the ISP get not to be able to send email messages in the cases below.</t>  <t><list style=\"numbers\">   <t>Subscribers use other MSAs than ones located inside the ISP. In this case, the subscribers subscribe to multiple ISPs.</t>   <t>Subscribers use the MSAs served by hosting providers or ASPs.</t>   <t>The ISP is a model B ISP.</t> </list></t>  <t>In all the cases listed above, subscribers uses the MSAs located outside of the ISPs which they subscribe. In this document, we call this kind of submission \\ufffd\\ufffd\\ufffdsubmissions to third-party servers\\ufffd\\ufffd\\ufffd. The implementation of OP25B causes problems with submissions to third-party servers. <xref target=\"fig_op25b_problem\"/> shows this problem. The number of the arrows in <xref target=\"fig_op25b_problem\"/> is correspondent to the number in the list above.</t>  <figure title=\"Problem with complete OP25B\" anchor=\"fig_op25b_problem\"><artwork><![CDATA[              +------------------------+  +------------------------+              |ASP/Hosting/            |  |Cellular carrier        |              |Business Enterprise/    |  |                        |              |Academic institution    |  |                        |              |    +--------------+    |  |  +-------+  +-------+  |              |    |   MSA/MTA    |    |  |  |  MTA  |  |  MSA  |  |              |    +--------------+    |  |  +-------+  +-------+  |              |        ^               |  |                        |              +--------|---------------+  +------------------------+ +------------+        + - - - - - - +                               |       ISP B|         (2)          |             +---------------+ |            |                                    |          ISP C| |  +-------+ |                      |         (1) |  +-------+    | |  |  MTA  | |                        - - - - - - | >|  MTA  |    | |  |  MSA  | |                      |             |  |  MSA  |    | |  +-------+ |                                    |  +-------+    | |    ^(3)    |                      |             |               | |            |                                    |               | | +--X------------------------------X-------+     +---------------+ | |  |       |                      |       |                       | |  |       |      +-------+       |       |       +---+    +---+  | |  |       |      |  MSA  |       |       |       |MUA|    |MUA|  | |  |       |      +-------+       |       |       +---+    +---+  | |  |       |                      |  ISP A|                       +-+--|-------+------------------------------+                            |                              |                                  +-+-+        +---+             +-+-+                                |MUA|        |MUA| bot(zombie) |MUA|                                +---+        +---+ spam sender +---+                             ]]></artwork></figure>  <t>ISP A in the figure is an ISP of model A, and ISP B is an ISP of model B. As described in former sections, mail submissions of subscribers in ISP B are forwarded through the backbone network of ISP A to MSAs of ISP B. When ISP A implements OP25B, the path of the line (3) is blocked by the operation. Then subscribers of ISP B cannot submit to their MSAs.</t>  <t>MUAs can use port number other than 25 for submissions to avoid this problem.      <vspace /> As described in <xref target=\"RFC6409\"/>, MUAs can use the submission port (port 587) for submissions.</t>  <figure title=\"Complete OP25B with submission port\" anchor=\"fig_op25b_solution\"><artwork><![CDATA[ +-------------+                  +-+-----------+-+ |             |                  | +-----------+ | |  +-------+  |        forwarding| | +-------+ | | |  |  MTA  | +------------------->[25]  MTA  | | | |  +-------+  |                  | | +-------+ | | |             |                  | +-+---------+ | +-------------+        submission|               |                  +-----------+   | +-----------+ |                  |    +---------->[587]------+ | |                  +----|------+   | | |  MSA  | | |                       ||         | | +-------+ | |                      +++-+       | +-----------+ |                      |MUA|       +---------------+                      +---+        ]]></artwork></figure>  <t><xref target=\"fig_op25b_solution\"/> shows a typical SMTP server configuration for complete OP25B. In this figure, MTA receives forwarded email messages on port 25 and MSA accept submissions from MUAs on port 587. With this configuration, users can keep submitting to their MSAs using the submission port that OP25B does not affect.. We detail the use of submission port in a following section (<xref target=\"sec_submission_port\"/>).</t>  </section> <section anchor=\"implementation\" title=\"Implementation\">  <section anchor=\"sec_op25b_cellular\" title=\"OP25B bound for cellular carriers\">  <t><list style=\"symbols\">   <t>If the implementation of complete OP25B requires time, ISPs SHOULD implement OP25B bound for cellular carriers only first. This operation is for the ISP operators.</t> </list></t>  <figure title=\"OP25B bound for cellular carriers only\" anchor=\"fig_op25b_cellular_only\"><artwork><![CDATA[              +------------------------+  +------------------------+              |ASP/Hosting/            |  |Cellular carrier        |              |Business Enterprise/    |  |                        |              |Academic institution    |  |                        |              |    +--------------+    |  |  +-------+  +-------+  |              |    |   MSA/MTA    |    |  |  |  MTA  |  |  MSA  |  |              |    +--------------+    |  |  +-------+  +-------+  |              |                        |  |    ^ ^          ^      |              +------------------------+  +----|-|----------|------+ +------------+    + - - - - - - - - - - - - - + |                   |       ISP B|    |     +-----------------------+          |  |            |          |                          |  +-------+ | (d)|     |           + - - - - - - - - - - -+               |  |  MTA  | |          |                          |  |  MSA  | |    |     |        (e)|              |  +-------+ |          |                          |            |    |     |           |              |            |          |                          | +---------------X-----|-----------+-------+      | |          |    |     |           |       |                       | |          |    | +-------+               |         | |          |    | |  MSA  |       |       |         | |          |    | +-------+               |        | |          |    |     ^           |  ISP A|                       +-+----------+----------|-------------------+                                         |     +-----------+                                  +---+        +-+-+             +-+-+                                |MUA|        |MUA| bot(zombie) |MUA|                                +---+        +---+ spam sender +---+                              ]]></artwork></figure>  <t><xref target=\"fig_op25b_cellular_only\"/> shows the mail distribution path to cellular carriers from ISP A. The line (d) means the spam distribution path from dynamic IP addresses to cellular carriers. The line labeled as (e) shows the submission path from ISP subscribers to third-party servers in cellular carriers. This line (e) does not exist in the real world, because MSAs in cellular carrier networks do not accept the submissions from outside of their domain. Additionally, MTAs in the cellular carriers do not accept submissions from the Internet. For these reasons, OP25B bound for cellular carrier is easier to implement for ISPs. This quickly clears spams from their dynamic IP address blocks to cellular carriers.</t>  </section> <section anchor=\"sec_submission_port\" title=\"Submission port (587)\">  <t><list style=\"symbols\">   <t>Mail system operators MUST serve MSAs which support the submission port (port number 587).</t>   <t>The operators MUST implement SMTP Auth on the MSAs.</t>   <t>Even for the local mail distributions, the subscribers SHOULD use SMTP Auth.</t>   <t>The POP ID/Password pairs SHOULD be identical with AUTH ID/Password of SMTP Auth.</t>   <t>MSAs MUST NOT serve POP before SMTP.</t>   <t>These operations are for the operators of MSAs which accept submissions from global IP addresses.</t> </list></t>  <figure title=\"OP25B with submission port\" anchor=\"fig_submission_port\"><artwork><![CDATA[ +------------+    ^                           |       ISP B|    |                           |            |                                |  +-------+ |    |                           |  |  MTA  | |                                |  |  MSA  | |    |                           |  +-------+ |                                |  [25][587+auth] |                           |    ^     ^ |                                | +--|-----|------X-------------------------+ | |  |     | |    |                         | | |  |     | |    | +-------+               | | |  |(b)  | (b') | |  MSA  |               | | |  |     | |    | +-------+               | | |  |     | |    |                    ISP A| +-+--|-----|-+----|-------------------------+      |     |      |                 |           +-+-+   |    +-+-+             +-+-+          |MUA+---+    |MUA| bot(zombie) |MUA|          +---+        +---+ spam sender +---+       ]]></artwork></figure>  <t>In <xref target=\"fig_submission_port\"/>, if the ISP A implements OP25B, the line (b) becomes a blocking target of the operation. In this case, subscribers become not to be able to keep using services they could utilize before. The ISP have to serve alternatives for the subscribers of ISP B to perform valid submissions to third-party MSAs of ISP B. One of the alternatives is the submission port (port number 587). A submission to the submission port of an MSA in ISP B is depicted as the line (b\\ufffd\\ufffd\\ufffd). The operators of MSAs which are used as third-party servers MUST serve the submission port immediately after the implementation of OP25B on ISP A. Then, subscribers can send email messages by re-configuring their MUAs properly.</t>  <t>When an MSA provides submission port, operators of the MSA MUST implement SMTP AUTH on it. In this case, the local mail distribution SHOULD be achieved via SMTP AUTH to prevent spam mails to the local domain.</t>  <t>The POP ID/Password pairs SHOULD be identical with AUTH ID/Password of SMTP Auth. In this case, MUAs can use POP ID/Password pairs to the authentications if AUTH ID/Password pair is not configured.</t>  <t>If SMTP AUTH is not implemented in the domain, spam sender simply switch their mail submission port from 25 to 587 and keep sending spams using the spam sender strategy pattern I as described in <xref target=\"sec_spam_strategies\"/>. After the implementation of SMTP AUTH on port 587, the operators can limit the number of email messages sent by single user ID.</t>  <t>MSAs MUST NOT serve POP before SMTP because of its architectural defect. In the POP before SMTP architecture, POP servers store the IP addresses from which the POP authentications succeeded for certain periods, and verify mail submissions using the IP address list. That is, if the IP addresses from which the MTA receives submitted email messages are in the IP address list, the submissions are taken as valid.</t>  <t>This IP address based authentication causes a serious security problem. Suppose a client which has successfully succeeded the POP authentication leaves the network. If a malicious node obtains the same IP address while the POP server still hold the IP address in the valid IP address list, the malicious node can send spams freely.</t>  <t>When the valid IP addresses are the global addresses of the NAT routers, the situation gets worse. In the case multiple MUAs behind a NAT router utilizes a same MSA located on the WAN side and a client PC which runs MUA get infected by a bot, the bot can send email messages via the MSA after an MUA on another PC has done the POP authentication for the MSA. If the healthy PC is configured to do the POP authentications periodically, it effectively cancels POP before SMTP authentication from the LAN behind the NAT router.</t>  </section> </section> <section anchor=\"sec_migration_submission_port\" title=\"Complete migration to submission port(587)\">  <t><list style=\"symbols\">   <t>For mail submissions, MUAs MUST utilize MSAs which support both of the submission port(port 587) and SMTP Auth.</t>   <t>The mail system operators MUST abolish the use of MSAs which utilize the port 25.</t>   <t>The operators MUST deny submissions to MTAs.</t>   <t>This operation is for the operators of MSAs which accept the submissions from global IP addresses.</t> </list></t>  <t>As mentioned in <xref target=\"sec_spam_strategies\"/>, the mail quota using SMTP AUTH is workable against the spam senders\\ufffd\\ufffd\\ufffd strategy pattern I. For this operation, all the mail submissions must be done with SMTP AUTH. While ISPs of model C do not need to sweep away the MSAs with port 25 and MTAs after all the submissions are completely done with SMTP Auth, the ISPs SHOULD migrate to port 587 for the users\\ufffd\\ufffd\\ufffd convenience if deployments of SMTP AUTH are still not be completed. The operation in the model C ISP is described in the following  section(<xref target=\"sec_op25b_isp_c\"/>).</t>  <t>For the completion of this operation, all the subscribers have to change the configurations of their MUAs. ISPs MUST encourage their subscribers to change the configurations of their MUAs.</t>  <t>Proposed migration steps are:</t>  <t><list style=\"numbers\">   <t>Operators of mail systems prepare MSA(s)[587+Auth] other than MTA/MSA[25].</t>   <t>For new subscribers, prepare the guidance of MSA[587+Auth] only.</t>   <t>For subscribers who need to change the configuration of MTAs on their MUAs (for example, users who want to change their mail addresses), show them a configuration guideline of MSA[587+Auth] only.</t>   <t>encourage all other subscribers to change their MUA configurations to MSA[587+Auth]</t> </list></t>  <t>The focuses or problems of the complete migration vary by the ISP models and network configurations. We explain the focuses and problems for 3 models below in the following sections.</t>  <t><list style=\"numbers\">   <t>ISP of model C</t>   <t>ISP of model A and B</t>   <t>providers which cannot identify submission sources (ex) ASP)</t> </list></t>  <t>Essentially, the categorization of the ISPs (model A, B and C) is not the categorization of the ISPs themselves but of the services which the ISPs provide for their subscribers. (An ISP can provide one service categorized as model A and another service of model B simultaneously) For simplicity, we use the above categorization over ISPs themselves in the following sections.</t>  <section anchor=\"sec_op25b_isp_c\" title=\"ISP of model C\">  <t>Operators of model C ISPs are able to implement OP25B while their MSAs and MTAs keep accepting submissions for port 25. This is because their OP25B implementations do not influence on mail services on other ISPs. Therefore, the operations described in <xref target=\"sec_migration_submission_port\"/> are not required in IPSs of model C.</t>  <figure title=\"Mail distribution path after OP25B in ISPs of model C\" anchor=\"fig_op25b_isp_c\"><artwork><![CDATA[              +------------------------+  +------------------------+              |ASP/Hosting/            |  |Cellular carrier        |              |Business Enterprise/    |  |                        |              |Academic institution    |  |                        |              |   +-------+-------+    |  |  +-------+  +-------+  |              |   |  MSA  |  MTA  |    |  |  |  MTA  |  |  MSA  |  |              |   +-------+-------+    |  |  +-------+  +-------+  |              |             [25]       |  |  [25]                  |              +---------------^--------+  +----^-------------------+ +------------+               |                |                     |       ISP B|               |                |   +---------------+ |            |               |                |   |          ISP C| | +--------+ |               |                |   | +--------+    | | | MTA [25]<----------------+----------------+-----|   MTA  |    | | | MSA    | |                                    | [25]MSA  |    | | +--------+ |                                    | +-^------+    | |            |                                    |   |           | |            |                                    |   |           | | +-----------------------------------------+     +---------------+ | |          |                              |         |             | |          |      +-------+               |       +-+-+    +---+  | |          |      |  MSA  |               |       |MUA|    |MUA|  | |          |      +-------+               |       +---+    +---+  | |          |                         ISP A|                       +-+----------+------------------------------+                                                                                              +---+        +---+             +---+                                |MUA|        |MUA| bot(zombie) |MUA|                                +---+        +---+ spam sender +---+                              ]]></artwork></figure>  </section> <section anchor=\"isp-of-model-a-and-b\" title=\"ISP of model A and B\">  <t><list style=\"symbols\">   <t>Operators of model B ISPs SHOULD cooperate with operators of model A ISPs.</t>   <t>Operators of model A ISPs SHOULD accept the requests from model B ISPs.</t>   <t>Operators of model A ISPs MUST keep their mail distribution paths for MSA[25] and MTA[25] until all the subscribers of model B ISPs complete the migrations to MSA[587+Auth].</t> </list></t>  <figure title=\"Mail distribution path of model B ISP\" anchor=\"fig_op25b_isp_a_b\"><artwork><![CDATA[              +------------------------+  +------------------------+              |ASP/Hosting/            |  |Cellular carrier        |              |Business Enterprise/    |  |                        |              |Academic institution    |  |                        |              |   +-------+-------+    |  |  +-------+  +-------+  |              |   |  MSA  |  MTA  |    |  |  |  MTA  |  |  MSA  |  |              |   +-------+-------+    |  |  +-------+  +-------+  |              |             [25]       |  |  [25]                  |              +---------------^--------+  +----^-------------------+ +------------+               |                |                     |       ISP B|               |                |   +---------------+ |            |               |                |   |          ISP C| |  +-------+ |               |                |   |  +-------+    | |  |  MTA  +-----------------+----------------+-->[25]  MTA  |    | |  |  MSA  | |                                    |  |  MSA  |    | |  +-------+ |                                    |  +-------+    | |  [25][587 auth]                                 |               | |    ^     ^ |                                    |               | | +--X-----|--------------------------------+     +---------------+ | |  |     | |                              |                       | |  |     | |      +-------+               |       +---+    +---+  | |  |(b)  | (b')   |  MSA  |               |       |MUA|    |MUA|  | |  |     | |      +-------+               |       +---+    +---+  | |  |     | |                         ISP A|                       +-+--|-----|-+----+-----------------+-------+                            |     |      |                 |                                  +-+-+   |    +-+-+             +-+-+                                |MUA+---+    |MUA| bot(zombie) |MUA|                                +---+        +---+ spam sender +---+                             ]]></artwork></figure>  <t>In <xref target=\"fig_op25b_isp_a_b\"/>, after ISP A implements OP25B, the subscribers in ISP B become not to be able to submit to their MTAs[25] and MSAs[25] (line (b)). Because ISP B does not have own backbone network and IP address blocks for subscribers, ISP B depends the implementation of OP25B on ISP A. Therefore, ISP A and ISP B have to cooperate with the implementation of OP25B.</t>  <t>Before the implementation of OP25B, ISP A and ISP B MUST choose one of the operations below.</t>  <t><list style=\"numbers\">   <t>ISP A permit the mail submissions from MUAs in ISP B to MSA[25] or MTA[25] of ISP B.</t>   <t>Subscribers of ISP B \\ufffd\\ufffd\\ufffdcompletely\\ufffd\\ufffd\\ufffd migrate SMTP server configurations of their MUAs to MSA[587+Auth]</t> </list></t>  <t>If ISP A and ISP B choose 1, the ACL problems arise in ISP A as described in <xref target=\"sec_op25b_top\"/>.  Regarding to the choice 2, the implementation of OP25B will be delayed. Below is a practical procedure of the OP25B implementation of ISP A and ISP B.</t>  <t><list style=\"numbers\">   <t>ISP B aggregates the address blocks for MSAs as few as possible.</t>   <t>ISP A permits submissions from subscribers of ISP B to MSAs[25] or MTA[25].</t>   <t>ISP A implements OP25B.</t>   <t>Subscribers of ISP B migrates SMTP server configurations of their MUAs to MSA[587+Auth].</t>   <t>ISP B stops to accept submissions to MSA[25] or MTA[25].</t> </list></t>  <t>The transition period is desirable to be as short as possible.</t>  </section> <section anchor=\"providers-which-cannot-identify-submission-sources\" title=\"Providers which cannot identify submission sources\">  <t>Providers which cannot identify submission sources MUST migrate to MSA[587+Auth] immediately. This operations is for the operators of MSAs which accept submissions from global IP addresses (especially for the operators of ASP or hosting companies).</t>  <figure title=\"Mail distribution path after OP25B in ASP of Hosting Providers\" anchor=\"fig_op25b_asp_hosting\"><artwork><![CDATA[              +------------------------+  +------------------------+              |ASP/Hosting/            |  |Cellular carrier        |              |Business Enterprise/    |  |                        |              |Academic institution    |  |                        |              |   +-------+-------+    |  |  +-------+  +-------+  |              |   |  MSA  |  MTA  |    |  |  |  MTA  |  |  MSA  |  |              |   +-------+-------+    |  |  +-------+  +-------+  |              |   [587+auth][25]       |  |                        |              +----------^----^--------+  +---- -------------------+ +------------+          |    |                                      |       ISP B|          |    |                    +---------------+ |            |          |    |                    |          ISP C| |  +-------+ |          |    |                    |  +-------+    | |  |  MTA  +----------+------+-------------------+   |  MTA  |    | |  |  MSA  | |        | |                         |  |  MSA  |    | |  +-------+ |        | +---------+               |  +-------+    | |            |        |           |               |               | |            |        |           |               |               | | +-------------------|---------------------+     +---------------+ | |          |        |           |         |                       | |          |      +-+-----+     |         |       +---+    +---+  | |          |      |  MSA  |     |         |       |MUA|    |MUA|  | |          |      +-------+     |         |       +---+    +---+  | |          |      [587+auth]    |    ISP A|                       +-+----------+----+-----^---------|-+-------+                                         |     +---------+ |                                  +---+        +-+-+             +-+-+                                |MUA|        |MUA| bot(zombie) |MUA|                                +---+        +---+ spam sender +---+                             ]]></artwork></figure>  <t>Providers which provide ASP services or hosting services cannot identify which ISP their users submit their email messages from. Such is the case with companies or academic institutions which allow submissions from the Internet. These providers MUST setup MSA[587+Auth] immediately and encourage their users to change their MUA configurations.</t>  <t>Because it requires time to implement SMTP AUTH, it is expected that these provides need to utilize POP before SMTP on the submission port as a temporary solution. Even in this case, as described in <xref target=\"sec_submission_port\"/>, the use of POP before SMTP is not recommended. It MUST be migrated to SMTP Auth as soon as possible.</t>  </section> <section anchor=\"related-item\" title=\"Related item\">  <t>In the case implementations of OP25B proceed, spam senders are expected to subscribe to the target ISP and send spams to the MTAs on the local domain. For this problem, ISPs SHOULD block the traffic from dynamic IP addresses of their IP address blocks to port 25 of MTAs. For this purpose, MSA and MTA have to obtain separated port numbers or separated IP addresses.</t>  </section> </section> <section anchor=\"considerations\" title=\"Considerations\">  <section anchor=\"attacks-against-op25b\" title=\"Attacks against OP25B\">  <t><list style=\"symbols\">   <t>TCP traffic which the source IP addresses are dynamic IP addresses and the destination port is 25 MUST be blocked.</t>   <t>Operators SHOULD implement some countermeasure for asymmetric routing attack and triangular spamming.</t> </list></t>  <t>These operations are for the operators of ISPs.</t>  <t>As OP25B blocks the email messages directly submitted to MTAs (not via MSAs), spam senders cannot send spam mails to the target directly after the implementations of OP25B. At the same time, valid users can keep sending email messages via submission port. How to implement OP25B is shown in <xref target=\"sec_op25b_top\"/>. In this section, we explain two notes while implementing OP25B.</t>  <t>We defined OP25B as \\ufffd\\ufffd\\ufffdfiltering of the TCP traffic  which the source addresses are dynamic IP addresses and the destination ports are 25\\ufffd\\ufffd\\ufffd in a former section (<xref target=\"sec_op25b_top\"/>). Even after the implementations of OP25B, it is known that the spam senders keep sending spam mails using some characteristics of IP communications. This attack is called \\ufffd\\ufffd\\ufffdasymmetric routing attack\\ufffd\\ufffd\\ufffd.</t>  <t><xref target=\"fig_op25b_asymmetric\"/> illustrates the asymmetric routing attack. First, the spam sender obtains two IP addresses, a static address and a dynamic IP address. The spam sender send spam mails which the source address is dynamic IP address via the network interface which has static IP address. Thus, the spam mails are transferred through the static IP address segment. If ACL for OP25b is not set on the gateway of the static IP address segment, the junk mails sent by the sender will be submitted to the target MSAs. The target MSA sends TCP responses to the dynamic IP address of the spam sender and the TCP connections from the spam sender to the target MSA are established.</t>  <figure title=\"Asymmetric routing attack\" anchor=\"fig_op25b_asymmetric\"><artwork><![CDATA[      +-------+           |  MSA  |           ++------+            |     ^             |     |             |     |             |     |             v     |       +-----+-+  ++-----+ |dynamic+--+static| +-------+  +------+  |               |   |  spam sender  |   |               |   +---------------+  ]]></artwork></figure>  <t>\\ufffd\\ufffd\\ufffdTriangular spamming\\ufffd\\ufffd\\ufffd<xref target=\"Triangular\"/> is a more generalized attack. Triangular spamming enables spam senders to bypass OP25B utilizing relaying nodes. <xref target=\"fig_op25b_triangular_spam\"/> illustrates triangular spamming. First, a spam sender sends IP packets which the source address is IP address of the spam relay node and the destination is the target MSA. As the source addresses are not the dynamic IP addresses of ISP1, the packets pass the ACL(s) of ISP1. The target MSA send responses which the destination is the spam relay node. The spam relay node forwards the packets modifying the destination IP address to the address of the original spam sender. This forwarded packets will be received by the spam sender not being blocked, because the in-bound ACLs are not configured in ISP1. Thus OP25B can be bypassed by triangular spamming.</t>  <figure title=\"Triangular spamming\" anchor=\"fig_op25b_triangular_spam\"><artwork><![CDATA[                  +----------------------+                                   |Internet              |                                   |       +-----+        |                              +------------+ MSA |<-----------+                          |    |       +-----+        |   |                          |    |                      |   |                          |    |                      |   |                          |    +----------------------+   |                          |                               |                          |                               |              +-----------|----------+          +---------|------------+ |ISP2       |          |          |ISP1     |            | |           |          |          |         |            | |           | +---------------------------+ |            | |           | |        |          |       | |            | |           | |        |          |       | |            | |           | |        |          |       | |            | +-----------|-|--------+          +-------|-|------------+             v |                           v |                    +-------+--+                        +-+-+                  |Spam Relay|                        |MUA|spam sender       +----------+                        +---+            ]]></artwork></figure>  <t>Countermeasures for these attacks are shown below.</t>  <t><list style=\"numbers\">   <t>Out of all the mail traffic from backbone networks to dynamic IP addresses, only the traffic which is from port 25 of designated MSAs are permitted. (traffic from \\ufffd\\ufffd\\ufffdother MSAs\\ufffd\\ufffd\\ufffd are blocked)</t>   <t>Prevent source address spoofing of the traffic from static or dynamic addresses to the backbone networks by source address validation.</t> </list></t>  <t>For asymmetric routing attack and triangular spamming, the adoption of source address validation (item 2) is more desirable than inbound ACL (item 1). However, as the implementations of source address validation are burdens in many cases, at least the operators SHOULD employ the inbound ACL (item 1) until source address validation is ready on the domain.</t>  </section> <section anchor=\"alternative-msa\" title=\"Alternative MSA\">  <t><list style=\"symbols\">   <t>Operators SHOULD provide third-party alternative MSAs.</t> </list></t>  <t>This operation is for the operators of ISPs.</t>  <t>To explain the need for alternative MSAs, we illustrate a mail user disrupted by OP25B.</t>  <t><list style=\"numbers\">   <t>User A is a subscriber of ISP A.</t>   <t>ISP A does not allow relays other than that for the email messages which the MAIL FROM field is within its own domain.</t>   <t>The user has another mail address \\ufffd\\ufffd\\ufffdfoo@example.com\\ufffd\\ufffd\\ufffd than that of ISP A.</t>   <t>The MSA of \\ufffd\\ufffd\\ufffdexample.com\\ufffd\\ufffd\\ufffd is located outside of ISP A and does not provide submission port.</t>   <t>The user cannot configure different FROM between Envelop and Header on her/his MUA.</t> </list></t>  <t>If the ISP A implements OP25B in this situation, the illustrated user gets to lose MSA and is not able to submit email messages. In this case, ISPs SHOULD provide the MSA[587+Auth] which users can configure their MAIL FROM field freely. This operation is not only for the users subscribed to ISPs themselves but for the providers which still have not implemented MSA[587+Auth].</t>  </section> <section anchor=\"mail-quota\" title=\"Mail quota\">  <t>Operators SHOULD implement mail quota on MSAs utilizing SMTP AUTH. The number of the email messages SHOULD be counted by \\ufffd\\ufffd\\ufffdRCPT TO\\ufffd\\ufffd\\ufffd.</t>  <t>After the implementations of OP25B and submission port, the only way mail senders submit their email messages is to use MSA[587+Auth] if the senders are using dynamic IP addresses. The way spam senders try to send junk mails via MSA[587+Auth] resembles to the spam sender strategy pattern I described in <xref target=\"sec_ips_models\"/>. As MSAs[587+Auth] can figure out the number of email messages sent from single user ID, operators SHOULD implement the mail quota using these mail sent counts. Operators have to decide the limit rate carefully not to influence on the mail deliveries of users other than the spam senders.</t>  <t>The number of outgoing email messages SHOULD be measured sorely by \\ufffd\\ufffd\\ufffdRCPT TO\\ufffd\\ufffd\\ufffd. In <xref target=\"RFC5321\"/>, the minimum total number of recipients is defined as 100. If the maximum number of the MAIL FROM is also limited to 100, mail senders can send 10,000 email messages(\\ufffd\\ufffd\\ufffdMAIL FROM\\ufffd\\ufffd\\ufffd * \\ufffd\\ufffd\\ufffdRCPT TO\\ufffd\\ufffd\\ufffd) from single MUA. If the number is measured by \\ufffd\\ufffd\\ufffdMAIL FROM\\ufffd\\ufffd\\ufffd and not considering \\ufffd\\ufffd\\ufffdRCPT TO\\ufffd\\ufffd\\ufffd, the combination tends to allow huge amount of outgoing email messages for each spam sender.</t>  </section> <section anchor=\"ipv6-consideration\" title=\"IPv6 Consideration\">  <t>TBD</t>  </section> <section anchor=\"acl-rules-to-permit-submission-port\" title=\"ACL rules to permit submission port\">  <t><list style=\"symbols\">   <t>Operators MUST configure to permit tcp 587 traffic to the Internet if MSAs which users have to communicate with are outside of their LANs.</t> </list></t>  <t>In this section, we describe the problems with OP25B other than the problems related to submissions to third-party servers. After the implementations of OP25B, there are cases caused by the ACL configurations on routers or firewalls. For example, MUAs cannot submit email messages in the case \\ufffd\\ufffd\\ufffdsome companies or academic institutions are using dynamic IP addresses and rely the capability of MSAs on ASP or hosting providers, and the submission port (587) is blocked\\ufffd\\ufffd\\ufffd. In this case, operators of the routers and firewalls MUST permit the traffic to submission port (587). In the case of proxies, the situation is the same. Proxies MUST forward the mail traffic to submission port (587).</t>  </section> <section anchor=\"mtas-with-dynamic-ip-addresses\" title=\"MTAs with dynamic IP addresses\">  <t><list style=\"symbols\">   <t>MTAs utilizing dynamic IP addresses SHOULD obtain static addresses.</t> </list></t>  <t>If there is an SMTP server which obtain a dynamic IP address and  resolves MX records to forward email messages directly to the destination MTAs, these forwarded traffic are blocked by OP25B configurations. Below are examples of this case.</t>  <t><list style=\"numbers\">   <t>The case the MTA is using dynamic IP address(es) and dynamic DNS.</t>   <t>The case send-only SMTP servers have dynamic IP addresses only.</t> </list></t>  <t>In these cases, operators of the servers SHOULD obtain static IP addresses.</t>  </section> </section> </section> <section anchor=\"the-goal-of-this-document\" title=\"The goal of this document\">  <t>After the implementation of OP25B, the mail distribution paths from ISP A are reformed as three figures below (<xref target=\"fig_op25b_valid_submission\"/>, <xref target=\"fig_op25b_valid_forwarding\"/>, <xref target=\"fig_op25b_invalid_submission\"/>).</t>  <figure title=\"Valid mail submission after OP25B\" anchor=\"fig_op25b_valid_submission\"><artwork><![CDATA[              +------------------------+  +------------------------+              |ASP/Hosting/            |  |Cellular carrier        |              |Business Enterprise/    |  |                        |              |Academic institution    |  |                        |              |    +--------------+    |  |  +-------+  +-------+  |              |    |   MSA/MTA    |    |  |  |  MTA  |  |  MSA  |  |              |    +--------------+    |  |  +-------+  +-------+  |              |    [587+Auth]  [25]    |  |  [25]                  |              +--------^---------------+  +------------------------+ +------------+        |                                             |       ISP B|        |                           +---------------+ |            |        |                           |          ISP C| |  +-------+ |        |                           |  +-------+    | |  |  MTA  |[25]      |                          [25]|  MTA  |    | |  |  MSA  | |        +-------------+----->[587+Auth]|  MSA  |    | |  +-------+ |                      |             | ^+-------+    | |  [587+Auth]|                      |             | |             | |    ^       |                      |             | |             | | +--|------------------------------|-------+     +-|-------------+ | |  |       |                      |       |       +-+             | |  |       |      +-------+       |       |       +-+-+    +---+  | |  |       |      |  MSA  |       |       |       |MUA|    |MUA|  | |  |       |      +-------+       |       |       +---+    +---+  | |  |       |      [587+Auth]      |  ISP A|                       +-+--|-------+--------^-------------|-------+                            |                +-------------+                                  +---+        +---+             +-+-+                                |MUA|        |MUA| bot(zombie) |MUA|                                +---+        +---+ spam sender +---+                             ]]></artwork></figure>  <t><xref target=\"fig_op25b_valid_submission\"/> depicts the valid mail submissions from MUA in ISP A. All the email messages are submitted to port 587 of MSAs. Even for the local domain submissions, MUA SHOULD use the submission port(587).</t>  <figure title=\"Valid mail forwarding after OP25B\" anchor=\"fig_op25b_valid_forwarding\"><artwork><![CDATA[              +------------------------+  +------------------------+              |ASP/Hosting/            |  |Cellular carrier        |              |Business Enterprise/    |  |                        |              |Academic institution    |  |                        |              |    +--------------+    |  |  +-------+  +-------+  |              |    |   MSA/MTA    |    |  |  |  MTA  |  |  MSA  |  |              |    +--------------+    |  |  +-------+  +-------+  |              |    [587+Auth]  [25]    |  |  [25]                  |              +-----------------^------+  +---^--------------------+ +------------+                 |             |                      |       ISP B|                 |             |    +---------------+ |            |                 |             |    |          ISP C| |  +-------+ |                 |             |    |  +-------+    | |  |  MTA  |[25]<-------+------+-------------+-->[25]|  MTA  |    | |  |  MSA  | |          |                  [587+Auth]|  MSA  |    | |  +-------+ |          |                         |  +-------+    | |  [587+Auth]|          |                         |               | |            |          |                         |               | | +---------------------|-------------------+     +---------------+ | |          |          |                   |                       | |          |      +---+---+               |       +---+    +---+  | |          |      |  MSA  |               |       |MUA|    |MUA|  | |          |      +-------+               |       +---+    +---+  | |          |      [587+Auth]         ISP A|                       +-+----------+------------------------------+                                                                                              +---+        +---+             +---+                                |MUA|        |MUA| bot(zombie) |MUA|                                +---+        +---+ spam sender +---+                             ]]></artwork></figure>  <t>MSAs in ISP A forward submitted email messages to port 25 of MTAs outside of ISP A. Because MSAs are allocated static IP addresses, the ACL rules of OP25B do not match the traffic.</t>  <figure title=\"Invalid mail submission after OP25B\" anchor=\"fig_op25b_invalid_submission\"><artwork><![CDATA[              +------------------------+  +------------------------+              |ASP/Hosting/            |  |Cellular carrier        |              |Business Enterprise/    |  |                        |              |Academic institution    |  |                        |              |    +--------------+    |  |  +-------+  +-------+  |              |    |   MSA/MTA    |    |  |  |  MTA  |  |  MSA  |  |              |    +--------------+    |  |  +-------+  +-------+  |              |    [587+Auth]  [25]    |  |  [25]                  |              +-----------------^------+  +---^--------------------+ +------------+                                                      |       ISP B|                 |             |    +---------------+ |            |                                    |          ISP C| |  +-------+ |                 |             |    |  +-------+    | |  |  MTA  |[25]< + - - - - - - - - - - - - - - >[25]|  MTA  |    | |  |  MSA  | |                             [587+Auth]|  MSA  |    | |  +-------+ |    |                               |  +-------+    | |  [587+Auth]|                                    |               | |            |    |                               |               | | +---------------X-------------------------+     +---------------+ | |          |    |                         |                       | |          |    | +-------+               |       +---+    +---+  | |          |    | |  MSA  |               |       |MUA|    |MUA|  | |          |    | +-------+               |       +---+    +---+  | |          |    | [587+Auth]         ISP A|                       +-+----------+----|-------------------------+                                         |                                                    +---+        +-+-+             +---+                                |MUA|        |MUA| bot(zombie) |MUA|                                +---+        +---+ spam sender +---+                             ]]></artwork></figure>  <t>All the submissions from dynamic IP addresses to port 25 of MSAs outside of ISP A are blocked by ACL rules of OP25B.</t>  </section> <section anchor=\"acknowledgements\" title=\"Acknowledgements\">  <t>The author would like to thank Rodney Van Meter for his good contributions to this memo.</t>  </section>     </middle>    <back>      <references title='Normative References'>      <reference anchor='RFC6409'>  <front> <title>Message Submission for Mail</title> <author initials='R.' surname='Gellens' fullname='R. Gellens'> <organization /></author> <author initials='J.' surname='Klensin' fullname='J. Klensin'> <organization /></author> <date year='2011' month='November' /> <abstract> <t>This memo splits message submission from message relay, allowing each service to operate according to its own rules (for security, policy, etc.), and specifies what actions are to be taken by a submission server.&lt;/t>&lt;t> Message relay is unaffected, and continues to use SMTP over port 25.&lt;/t>&lt;t> When conforming to this document, message submission uses the protocol specified here, normally over port 587.&lt;/t>&lt;t> This separation of function offers a number of benefits, including the ability to apply specific security or policy requirements. [STANDARDS-TRACK]</t></abstract></front>  <seriesInfo name='STD' value='72' /> <seriesInfo name='RFC' value='6409' /> <format type='TXT' octets='40153' target='http://www.rfc-editor.org/rfc/rfc6409.txt' /> </reference>    <reference anchor='RFC5598'>  <front> <title>Internet Mail Architecture</title> <author initials='D.' surname='Crocker' fullname='D. Crocker'> <organization /></author> <date year='2009' month='July' /> <abstract> <t>Over its thirty-five-year history, Internet Mail has changed significantly in scale and complexity, as it has become a global infrastructure service.  These changes have been evolutionary, rather than revolutionary, reflecting a strong desire to preserve both its installed base and its usefulness.  To collaborate productively on this large and complex system, all participants need to work from a common view of it and use a common language to describe its components and the interactions among them.  But the many differences in perspective currently make it difficult to know exactly what another participant means.  To serve as the necessary common frame of reference, this document describes the enhanced Internet Mail architecture, reflecting the current service.  This memo provides information for the Internet community.</t></abstract></front>  <seriesInfo name='RFC' value='5598' /> <format type='TXT' octets='115741' target='http://www.rfc-editor.org/rfc/rfc5598.txt' /> <format type='PDF' octets='342738' target='http://www.rfc-editor.org/rfc/rfc5598.pdf' /> </reference>    <reference anchor='RFC5321'>  <front> <title>Simple Mail Transfer Protocol</title> <author initials='J.' surname='Klensin' fullname='J. Klensin'> <organization /></author> <date year='2008' month='October' /> <abstract> <t>This document is a specification of the basic protocol for Internet electronic mail transport.  It consolidates, updates, and clarifies several previous documents, making all or parts of most of them obsolete.  It covers the SMTP extension mechanisms and best practices for the contemporary Internet, but does not provide details about particular extensions.  Although SMTP was designed as a mail transport and delivery protocol, this specification also contains information that is important to its use as a \"mail submission\" protocol for \"split-UA\" (User Agent) mail reading systems and mobile environments. [STANDARDS-TRACK]</t></abstract></front>  <seriesInfo name='RFC' value='5321' /> <format type='TXT' octets='225929' target='http://www.rfc-editor.org/rfc/rfc5321.txt' /> </reference>    <reference anchor='RFC5322'>  <front> <title>Internet Message Format</title> <author initials='P.' surname='Resnick' fullname='Peter W.  Resnick' role='editor'> <organization>Qualcomm Incorporated</organization> <address> <postal> <street>5775 Morehouse Drive</street> <city>San Diego</city> <region>CA</region> <code>92121-1714</code> <country>US</country></postal> <phone>+1 858 651 4478</phone> <email>presnick@qualcomm.com</email> <uri>http://www.qualcomm.com/~presnick/</uri></address></author> <date year='2008' month='October' /> <abstract> <t>This document specifies the Internet  Message Format (IMF), a syntax for text messages    that are sent between computer users, within  the framework of \"electronic mail\"    messages. This specification is a revision of  Request For Comments (RFC) 2822, which    itself superseded Request For Comments (RFC)  822, \"Standard for the Format of ARPA    Internet Text Messages\", updating it to  reflect current practice and incorporating    incremental changes that were specified in  other RFCs.</t></abstract></front>  <seriesInfo name='RFC' value='5322' /> <format type='TXT' octets='122322' target='http://www.rfc-editor.org/rfc/rfc5322.txt' /> <format type='HTML' octets='213393' target='http://xml.resource.org/public/rfc/html/rfc5322.html' /> <format type='XML' octets='174234' target='http://xml.resource.org/public/rfc/xml/rfc5322.xml' /> </reference>         </references>      <references title='Informative References'>  <reference anchor=\"Triangular\" >   <front>     <title>Investigation of Triangular Spamming a Stealthy and Efficient Spamming Technique</title>     <author initials=\"Z.\" surname=\"Qian\" fullname=\"Zhiyun Qian\">       <organization></organization>     </author>     <date year=\"2010\" month=\"May\"/>   </front>   <seriesInfo name=\"In proceedings of IEEE Symposium on Security and Privacy (Oakland) 2010\" value=\"\"/> </reference>       </references>      </back> </rfc>  ", 
    "identity": {
        "subtype": "", 
        "is_error": false, 
        "version": "", 
        "protocol": "", 
        "language": "", 
        "service": "", 
        "has_dataset": false, 
        "has_metadata": false
    }, 
    "digest": "f901d778ce11fb84366755194ad291b8", 
    "source_url": "http://www.ietf.org/id/draft-akagiri-op25b-dynamicip-00.xml"
}